import{j as s,r as h,L as S,u as w}from"./index-39c65143.js";import{a as N}from"./roesc-e5813c88.js";import{g as D}from"./fetchData-d16b6d81.js";import{p as E,M as j}from"./Markdown-3e4b824a.js";import{T as P}from"./Table-aa9625fc.js";import{T as u,C as x,M as A}from"./Media-3af09a5e.js";import{O as M,g as b,f as C,c as k}from"./OutLink-45fd4ae7.js";import{M as B}from"./MediaSection-3095c9fe.js";import{s as p,v as L,B as v}from"./BiddingTable-907a1931.js";import{U as T}from"./UsersString-5509d2b1.js";import{g as R}from"./broadcasters-2b78508b.js";import"./countryList-fb00d126.js";import"./users-51239890.js";function f({data:i,titleOnly:l}){const e=l?i.title:`${i.artists.join(", ")} - ${i.title}`;return s.jsx("span",{children:s.jsx(M,{to:i.link,children:e})})}function $({ids:i}){const[l,e]=h.useState([]);return h.useEffect(()=>{const n=i.filter(t=>!!t).map(t=>R(t));Promise.all(n).then(t=>{e(t.map((r,c)=>s.jsxs(S,{to:`/broadcasters/${r.link}`,children:[r.name,c===t.length-1?"":", "]},r.id)))})},[i]),l}function I({data:i,roescData:l}){return s.jsx("div",{className:"table-container sideTable",style:{float:"right",marginLeft:"1rem"},children:s.jsxs("table",{className:"table is-bordered is-striped is-hoverable",children:[s.jsx("thead",{children:s.jsx("tr",{style:{textAlign:"center"},children:s.jsxs("th",{colSpan:2,children:[l.name," ",i.edition]})})}),s.jsxs("tbody",{children:[b(i.media,"logos").length>0?s.jsx("tr",{children:s.jsx("td",{colSpan:2,children:s.jsx(B,{link:b(i.media,"logos")[0].link})})}):"",s.jsxs("tr",{children:[s.jsx("th",{children:"Presenters"}),s.jsx("td",{children:i.presenters.map((e,n)=>s.jsxs("span",{children:[e.name," ",e.id&&s.jsxs("span",{children:["(",s.jsx(T,{userids:[e.id]}),")"]}),s.jsx("br",{})]},n))})]}),i.broadcasters.length>0&&s.jsxs("tr",{children:[s.jsx("th",{children:"Broadcaster"}),s.jsx("td",{children:s.jsx($,{ids:i.broadcasters})})]}),s.jsx("tr",{style:{textAlign:"center"},children:s.jsx("th",{colSpan:2,children:"Dates"})}),i.shows.map(e=>s.jsxs("tr",{children:[s.jsx("th",{children:p[e.id]}),s.jsx("td",{children:E(e.date)})]},e.id)),s.jsx("tr",{style:{textAlign:"center"},children:s.jsx("th",{colSpan:2,children:"Opening Acts"})}),i.shows.map(e=>s.jsxs("tr",{children:[s.jsx("th",{children:p[e.id]}),s.jsx("td",{children:e.openings.map((n,t)=>s.jsxs("div",{children:[s.jsx(f,{data:n}),s.jsx("br",{})]},t))})]},e.id)),s.jsx("tr",{style:{textAlign:"center"},children:s.jsx("th",{colSpan:2,children:"Interval Acts"})}),i.shows.map(e=>s.jsxs("tr",{children:[s.jsx("th",{children:p[e.id]}),s.jsx("td",{children:e.intervals.map((n,t)=>s.jsxs("div",{children:[s.jsx(f,{data:n}),s.jsx("br",{})]},t))})]},e.id))]})]})})}function O(i,l){var c;const e=l.votingMethod,n=(c=L.find(a=>a.value===e))==null?void 0:c.points[0],t=[];i.entries.forEach(a=>{const d=a.shows.find(o=>o.id===l.id);if(d&&d.votes&&d.votes[0]){const o=d.votes[0],m=t.find(g=>g.country=o);m?m.givers.push(a.country):t.push({country:o,givers:[a.country]})}});const r={maxPoints:n,getters:t};return console.log(r),r}function q({data:i,show:l}){const e=O(i,l);return s.jsx(u,{children:s.jsxs("table",{className:"table is-bordered is-striped is-hoverable is-narrow",style:{width:"inherit"},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"N."}),s.jsx("th",{children:"Contestant"}),s.jsxs("th",{children:["Nation(s) giving ",e.maxPoints," points"]})]})}),s.jsx("tbody",{children:e.getters.map((n,t)=>s.jsxs("tr",{children:[s.jsx("th",{children:n.givers.length}),s.jsx("td",{children:s.jsx(x,{id:n.country})}),s.jsx("td",{children:n.givers.map((r,c)=>s.jsx(x,{id:r},c))})]},t))})]})})}function F(i,l){const e=[];return i.entries.forEach(n=>{const t=n.shows.find(r=>r.id===l);if(t){let r="";t.qualified&&(r="selected"),l==="gf"&&(console.log(t),t.place===1?r="firstplace":t.place===2?r="secondplace":t.place===3&&(r="thirdplace")),e.push({ro:t.order,country:n.country,participant:n.hods,song:n.song,place:t.place,points:t.points.total,qualified:t.qualified,className:r})}}),e.sort((n,t)=>n.ro-t.ro),e}function G({show:i,data:l}){return s.jsx(u,{children:s.jsx("div",{className:"my-5",children:s.jsx(P,{columns:["Order","Country","Participant","Artist","Song","Place","Points"],smallFirst:!0,compact:!0,children:F(l,i).map((e,n)=>s.jsxs("tr",{className:e.className,children:[s.jsx("td",{style:{textAlign:"center"},children:C(e.ro)}),s.jsx("td",{children:s.jsx(x,{id:e.country})}),s.jsx("td",{children:s.jsx(T,{userids:e.participant})}),s.jsx("td",{children:e.song.artists}),s.jsx("td",{children:s.jsx(f,{data:e.song,titleOnly:!0})}),s.jsx("td",{children:e.place}),s.jsx("td",{children:e.points})]},n))})})})}function y(i,l,e){const n=[];return i.entries.forEach(t=>{const r=t.shows.find(c=>c.id===l);if(r){let c="";r.qualified&&(c="selected"),n.push({country:t.country,juryPoints:r.points.jury,telePoints:r.points.tele,className:c})}}),n.sort((t,r)=>r[e]-t[e])}function J({show:i,data:l}){const e=y(l,i,"juryPoints"),n=y(l,i,"telePoints");return s.jsx(u,{children:s.jsx("div",{className:"my-5",children:s.jsx("div",{className:"table-container",children:s.jsxs("table",{className:"table is-bordered is-striped is-hoverable is-narrow",style:{width:"inherit"},children:[s.jsxs("thead",{children:[s.jsx("tr",{children:s.jsx("th",{style:{textAlign:"center"},colSpan:5,children:"Split Results"})}),s.jsxs("tr",{style:{textAlign:"center"},children:[s.jsx("th",{rowSpan:2,children:"Place"}),s.jsx("th",{colSpan:2,children:"Jury"}),s.jsx("th",{colSpan:2,children:"Televoting"})]}),s.jsxs("tr",{children:[s.jsx("th",{children:"Country"}),s.jsx("th",{children:"Points"}),s.jsx("th",{children:"Country"}),s.jsx("th",{children:"Points"})]})]}),s.jsx("tbody",{children:e.map((t,r)=>s.jsxs("tr",{children:[s.jsx("th",{style:{textAlign:"center"},children:r+1}),s.jsx("td",{children:s.jsx(x,{id:t.country})}),s.jsx("td",{children:t.juryPoints}),s.jsx("td",{children:s.jsx(x,{id:n[r].country})}),s.jsx("td",{children:n[r].telePoints})]},r))})]})})})})}function U({data:i,show:l}){return s.jsxs("div",{className:"mb-5",children:[s.jsx("h2",{children:p[l.id]}),s.jsx(j,{value:l.textContent}),s.jsx(G,{data:i,show:l.id}),s.jsxs("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-around",flexWrap:"wrap"},children:[s.jsx(J,{data:i,show:l.id}),s.jsx(q,{data:i,show:l})]})]})}function is(){const{roesc:i,edition:l}=w(),[e,n]=h.useState(),[t,r]=h.useState(),[c,a]=h.useState("");return h.useEffect(()=>{N(i,l).then(d=>n(d)).catch(d=>a(d)),D(i).then(d=>r(d)).catch(()=>{})},[i,l]),!e||!t?s.jsx("h1",{children:"Loading..."}):c?s.jsxs("h1",{children:["Error: ",c]}):s.jsxs("div",{children:[s.jsx("h1",{children:e.fullName}),s.jsx("hr",{}),s.jsx(I,{data:e,roescData:t}),s.jsx(j,{value:e.textContent}),(e.biddingText||e.bidding.length>0)&&s.jsxs(s.Fragment,{children:[s.jsx("h1",{children:"Location"}),s.jsx("hr",{}),s.jsx(j,{value:e.biddingText,overrides:{BiddingTable:{component:v,props:{data:e.bidding}}}}),e.bidding.length>0&&!k(e.biddingText,"BiddingTable")&&s.jsx(v,{data:e.bidding})]}),(e.sfDrawText||e.sfDraw.length>0)&&s.jsxs(s.Fragment,{children:[s.jsx("h1",{children:"Semi-Final Allocation Draw"}),s.jsx("hr",{}),s.jsx(j,{value:e.sfDrawText}),s.jsx(u,{children:s.jsx(P,{columns:e.sfDraw.map((d,o)=>`Pot ${o+1}`),children:s.jsx("tr",{children:e.sfDraw.map((d,o)=>s.jsx("td",{children:s.jsx("ul",{style:{marginTop:0},children:d.map((m,g)=>s.jsx("li",{children:s.jsx(x,{id:m})},g))})},o))})})})]}),s.jsx("h1",{children:"Shows"}),s.jsx("hr",{}),e.shows.map(d=>s.jsx(U,{show:d,data:e},d.id)),s.jsx("div",{style:{marginTop:"2rem"}}),s.jsx("h1",{children:"Incidents"}),s.jsx("hr",{}),s.jsx(j,{value:e.incidents}),s.jsx("div",{style:{marginTop:"2rem"}}),s.jsx(A,{media:e.media}),s.jsx("hr",{style:{clear:"both"}}),s.jsx(S,{to:`/editor/edition/existing/${t.link}/${e.link}`,className:"button is-primary is-outlined",children:"Edit This Page"})]})}export{is as default};
