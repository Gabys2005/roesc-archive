import{j as s,r as x,L as T,u as N}from"./index-66c1ed07.js";import{a as D}from"./roesc-65b909f4.js";import{g as E}from"./fetchData-fdb5cced.js";import{p as A,M as j}from"./Markdown-3f3254c5.js";import{T as g}from"./Table-48e4936a.js";import{T as u,C as h,M as C}from"./Media-1cf871db.js";import{O as M,g as y,f as k,c as B}from"./OutLink-a05df080.js";import{M as F}from"./MediaSection-40156ace.js";import{s as f,v as R,B as S}from"./BiddingTable-d526a3e3.js";import{U as b}from"./UsersString-c322efe8.js";import{g as L}from"./broadcasters-b062008d.js";import"./countryList-fb00d126.js";import"./users-336392cd.js";function v({data:n,titleOnly:t}){const e=t?n.title:`${n.artists.join(", ")} - ${n.title}`;return s.jsx("span",{children:s.jsx(M,{to:n.link,children:e})})}function $({ids:n}){const[t,e]=x.useState([]);return x.useEffect(()=>{const l=n.filter(i=>!!i).map(i=>L(i));Promise.all(l).then(i=>{e(i.map((r,o)=>s.jsxs(T,{to:`/broadcasters/${r.link}`,children:[r.name,o===i.length-1?"":", "]},r.id)))})},[n]),t}function w({name:n,shows:t,showIndex:e}){const l=t.filter(i=>i[e].length>0);return l.length===0?s.jsx(s.Fragment,{}):s.jsxs(s.Fragment,{children:[s.jsx("tr",{style:{textAlign:"center"},children:s.jsxs("th",{colSpan:2,children:[n," Acts"]})}),l.map(i=>s.jsxs("tr",{children:[s.jsx("th",{children:f[i.id]}),s.jsx("td",{children:i[e].map((r,o)=>s.jsxs("div",{children:[s.jsx(v,{data:r}),s.jsx("br",{})]},o))})]},i.id))]})}function I({data:n,roescData:t}){return s.jsx("div",{className:"table-container sideTable",style:{float:"right",marginLeft:"1rem"},children:s.jsxs("table",{className:"table is-bordered is-striped is-hoverable",children:[s.jsx("thead",{children:s.jsx("tr",{style:{textAlign:"center"},children:s.jsxs("th",{colSpan:2,children:[t.name," ",n.edition]})})}),s.jsxs("tbody",{children:[y(n.media,"logos").length>0?s.jsx("tr",{children:s.jsx("td",{colSpan:2,children:s.jsx(F,{link:y(n.media,"logos")[0].link})})}):"",s.jsxs("tr",{children:[s.jsx("th",{children:"Presenters"}),s.jsx("td",{children:n.presenters.map((e,l)=>s.jsxs("span",{children:[e.name," ",e.id&&s.jsxs("span",{children:["(",s.jsx(b,{userids:[e.id]}),")"]}),s.jsx("br",{})]},l))})]}),n.broadcasters.length>0&&s.jsxs("tr",{children:[s.jsx("th",{children:"Broadcaster"}),s.jsx("td",{children:s.jsx($,{ids:n.broadcasters})})]}),s.jsx("tr",{style:{textAlign:"center"},children:s.jsx("th",{colSpan:2,children:"Dates"})}),n.shows.map(e=>s.jsxs("tr",{children:[s.jsx("th",{children:f[e.id]}),s.jsx("td",{children:A(e.date)})]},e.id)),s.jsx(w,{name:"Opening",shows:n.shows,showIndex:"openings"}),s.jsx(w,{name:"Interval",shows:n.shows,showIndex:"intervals"})]})]})})}function O(n,t){var o;const e=t.votingMethod,l=(o=R.find(a=>a.value===e))==null?void 0:o.points[0],i=[];return n.entries.forEach(a=>{const d=a.shows.find(c=>c.id===t.id);if(d&&d.votes&&d.votes[0]){const c=d.votes[0],m=i.find(p=>p.country=c);m?m.givers.push(a.country):i.push({country:c,givers:[a.country]})}}),{maxPoints:l,getters:i}}function q({data:n,show:t}){const e=O(n,t);return e.getters.length===0?s.jsx(s.Fragment,{}):s.jsx(u,{children:s.jsxs("table",{className:"table is-bordered is-striped is-hoverable is-narrow",style:{width:"inherit"},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"N."}),s.jsx("th",{children:"Contestant"}),s.jsxs("th",{children:["Nation(s) giving ",e.maxPoints," points"]})]})}),s.jsx("tbody",{children:e.getters.map((l,i)=>s.jsxs("tr",{children:[s.jsx("th",{children:l.givers.length}),s.jsx("td",{children:s.jsx(h,{id:l.country})}),s.jsx("td",{children:l.givers.map((r,o)=>s.jsx(h,{id:r},o))})]},i))})]})})}function W(n,t){const e=[];return n.entries.forEach(l=>{const i=l.shows.find(r=>r.id===t);if(i){let r="";i.qualified&&(r="selected"),t==="gf"&&(console.log(i),i.place===1?r="firstplace":i.place===2?r="secondplace":i.place===3&&(r="thirdplace")),e.push({ro:i.order,country:l.country,participant:l.hods,song:l.song,place:i.place,points:i.points.total,qualified:i.qualified,className:r})}}),e.sort((l,i)=>l.ro-i.ro),e}function G({entries:n}){return s.jsx(u,{children:s.jsx("div",{className:"my-5",children:s.jsx(g,{columns:["Order","Country","Participant","Artist","Song","Place","Points"],smallFirst:!0,compact:!0,children:n.map((t,e)=>s.jsxs("tr",{className:t.className,children:[s.jsx("td",{style:{textAlign:"center"},children:k(t.ro)}),s.jsx("td",{children:s.jsx(h,{id:t.country})}),s.jsx("td",{children:s.jsx(b,{userids:t.participant})}),s.jsx("td",{children:t.song.artists}),s.jsx("td",{children:s.jsx(v,{data:t.song,titleOnly:!0})}),s.jsx("td",{children:t.place}),s.jsx("td",{children:t.points})]},e))})})})}function J({entries:n}){return s.jsx(u,{children:s.jsx("div",{className:"my-5",children:s.jsx(g,{columns:["Country","Participant","Artist","Song"],compact:!0,children:n.map((t,e)=>s.jsxs("tr",{className:t.className,children:[s.jsx("td",{children:s.jsx(h,{id:t.country})}),s.jsx("td",{children:s.jsx(b,{userids:t.participant})}),s.jsx("td",{children:t.song.artists}),s.jsx("td",{children:s.jsx(v,{data:t.song,titleOnly:!0})})]},e))})})})}function U({show:n,data:t}){const e=W(t,n);return e.find(i=>i.ro!=0||i.place!=0||i.points!=0)?s.jsx(G,{entries:e}):s.jsx(J,{entries:e})}function P(n,t,e){const l=[];return n.entries.forEach(i=>{const r=i.shows.find(o=>o.id===t);if(r){let o="";r.qualified&&(o="selected"),l.push({country:i.country,juryPoints:r.points.jury,telePoints:r.points.tele,className:o})}}),l.sort((i,r)=>r[e]-i[e])}function _({show:n,data:t}){const e=P(t,n,"juryPoints"),l=P(t,n,"telePoints");return!e.find(r=>r.juryPoints!=0||r.telePoints!=0)?s.jsx(s.Fragment,{}):s.jsx(u,{children:s.jsx("div",{className:"my-5",children:s.jsx("div",{className:"table-container",children:s.jsxs("table",{className:"table is-bordered is-striped is-hoverable is-narrow",style:{width:"inherit"},children:[s.jsxs("thead",{children:[s.jsx("tr",{children:s.jsx("th",{style:{textAlign:"center"},colSpan:5,children:"Split Results"})}),s.jsxs("tr",{style:{textAlign:"center"},children:[s.jsx("th",{rowSpan:2,children:"Place"}),s.jsx("th",{colSpan:2,children:"Jury"}),s.jsx("th",{colSpan:2,children:"Televoting"})]}),s.jsxs("tr",{children:[s.jsx("th",{children:"Country"}),s.jsx("th",{children:"Points"}),s.jsx("th",{children:"Country"}),s.jsx("th",{children:"Points"})]})]}),s.jsx("tbody",{children:e.map((r,o)=>s.jsxs("tr",{children:[s.jsx("th",{style:{textAlign:"center"},children:o+1}),s.jsx("td",{children:s.jsx(h,{id:r.country})}),s.jsx("td",{children:r.juryPoints}),s.jsx("td",{children:s.jsx(h,{id:l[o].country})}),s.jsx("td",{children:l[o].telePoints})]},o))})]})})})})}function z({data:n,show:t}){return s.jsxs("div",{className:"mb-5",children:[s.jsx("h2",{children:f[t.id]}),s.jsx(j,{value:t.textContent}),s.jsx(U,{data:n,show:t.id}),s.jsxs("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-around",flexWrap:"wrap"},children:[s.jsx(_,{data:n,show:t.id}),s.jsx(q,{data:n,show:t})]})]})}function ls(){const{roesc:n,edition:t}=N(),[e,l]=x.useState(),[i,r]=x.useState(),[o,a]=x.useState("");return x.useEffect(()=>{D(n,t).then(d=>l(d)).catch(d=>a(d)),E(n).then(d=>r(d)).catch(()=>{})},[n,t]),!e||!i?s.jsx("h1",{children:"Loading..."}):o?s.jsxs("h1",{children:["Error: ",o]}):s.jsxs("div",{children:[s.jsx("h1",{children:e.fullName}),s.jsx("hr",{}),s.jsx(I,{data:e,roescData:i}),s.jsx(j,{value:e.textContent}),(e.biddingText||e.bidding.length>0)&&s.jsxs(s.Fragment,{children:[s.jsx("h1",{children:"Location"}),s.jsx("hr",{}),s.jsx(j,{value:e.biddingText,overrides:{BiddingTable:{component:S,props:{data:e.bidding}}}}),e.bidding.length>0&&!B(e.biddingText,"BiddingTable")&&s.jsx(S,{data:e.bidding})]}),(e.sfDrawText||e.sfDraw.length>0)&&s.jsxs(s.Fragment,{children:[s.jsx("h1",{children:"Semi-Final Allocation Draw"}),s.jsx("hr",{}),s.jsx(j,{value:e.sfDrawText}),s.jsx(u,{children:s.jsx(g,{columns:e.sfDraw.map((d,c)=>`Pot ${c+1}`),children:s.jsx("tr",{children:e.sfDraw.map((d,c)=>s.jsx("td",{children:s.jsx("ul",{style:{marginTop:0},children:d.map((m,p)=>s.jsx("li",{children:s.jsx(h,{id:m})},p))})},c))})})})]}),s.jsx("h1",{children:"Shows"}),s.jsx("hr",{}),e.shows.map(d=>s.jsx(z,{show:d,data:e},d.id)),s.jsx("div",{style:{marginTop:"2rem"}}),s.jsx("h1",{children:"Incidents"}),s.jsx("hr",{}),s.jsx(j,{value:e.incidents}),s.jsx("div",{style:{marginTop:"2rem"}}),s.jsx(C,{media:e.media}),s.jsx("hr",{style:{clear:"both"}}),s.jsx(T,{to:`/editor/edition/existing/${i.link}/${e.link}`,className:"button is-primary is-outlined",children:"Edit This Page"})]})}export{ls as default};
