import{j as s,r as m,L as D,u as F}from"./index-11b50e1b.js";import{a as M}from"./roesc-ff4e6864.js";import{g as k}from"./fetchData-31fc4ce1.js";import{p as O,M as p}from"./Markdown-192092f6.js";import{T as f}from"./Table-54b5198d.js";import{T as j,C as x,M as $}from"./Media-27e08398.js";import{O as B,g as P,f as R,c as L}from"./OutLink-5202f1c5.js";import{M as I}from"./MediaSection-f74a564d.js";import{s as w,v as E,B as T}from"./BiddingTable-83ecda22.js";import{U as v}from"./UsersString-0a8ef2dc.js";import{g as q}from"./broadcasters-5c948c96.js";import"./countryList-498b3ce4.js";import"./users-45c85a33.js";function b({data:t,titleOnly:n}){const e=n?t.title:`${t.artists.join(", ")} - ${t.title}`;return s.jsx("span",{children:s.jsx(B,{to:t.link,children:e})})}function J({ids:t}){const[n,e]=m.useState([]);return m.useEffect(()=>{const r=t.filter(i=>!!i).map(i=>q(i));Promise.all(r).then(i=>{e(i.map((l,d)=>s.jsxs(D,{to:`/broadcasters/${l.link}`,children:[l.name,d===i.length-1?"":", "]},l.id)))})},[t]),n}function A({name:t,shows:n,showIndex:e}){const r=n.filter(i=>i[e].length>0);return r.length===0?s.jsx(s.Fragment,{}):s.jsxs(s.Fragment,{children:[s.jsx("tr",{style:{textAlign:"center"},children:s.jsxs("th",{colSpan:2,children:[t," Acts"]})}),r.map(i=>s.jsxs("tr",{children:[s.jsx("th",{children:w[i.id]}),s.jsx("td",{children:i[e].map((l,d)=>s.jsxs("div",{children:[s.jsx(b,{data:l}),s.jsx("br",{})]},d))})]},i.id))]})}function W({data:t,roescData:n}){return s.jsx("div",{className:"table-container sideTable",style:{float:"right",marginLeft:"1rem"},children:s.jsxs("table",{className:"table is-bordered is-striped is-hoverable",children:[s.jsx("thead",{children:s.jsx("tr",{style:{textAlign:"center"},children:s.jsxs("th",{colSpan:2,children:[n.name," ",t.edition]})})}),s.jsxs("tbody",{children:[P(t.media,"logos").length>0?s.jsx("tr",{children:s.jsx("td",{colSpan:2,children:s.jsx(I,{link:P(t.media,"logos")[0].link})})}):"",t.presenters.length>0&&s.jsxs("tr",{children:[s.jsx("th",{children:"Presenters"}),s.jsx("td",{children:t.presenters.map((e,r)=>s.jsxs("span",{children:[e.name," ",e.id&&s.jsxs("span",{children:["(",s.jsx(v,{userids:[e.id]}),")"]}),s.jsx("br",{})]},r))})]}),t.broadcasters.length>0&&s.jsxs("tr",{children:[s.jsx("th",{children:"Broadcaster"}),s.jsx("td",{children:s.jsx(J,{ids:t.broadcasters})})]}),s.jsx("tr",{style:{textAlign:"center"},children:s.jsx("th",{colSpan:2,children:"Dates"})}),t.shows.map(e=>s.jsxs("tr",{children:[s.jsx("th",{children:w[e.id]}),s.jsx("td",{children:O(e.date)})]},e.id)),s.jsx(A,{name:"Opening",shows:t.shows,showIndex:"openings"}),s.jsx(A,{name:"Interval",shows:t.shows,showIndex:"intervals"})]})]})})}function g({children:t}){return s.jsx("span",{style:{writingMode:"vertical-rl",transform:"rotate(180deg)"},children:t})}function G(t,n){var h;const e=[],r=[],i=n.votingMethod,l=((h=E.find(c=>c.value===i))==null?void 0:h.points)||[],d=l[0];return t.entries.forEach(c=>{const o=c.shows.find(a=>a.id===n.id);o!=null&&o.shouldveVoted&&r.push({country:c.country,order:o.order!==0?o.order:-1e3,votes:o.votes})}),r.sort((c,o)=>o.order-c.order),t.entries.forEach(c=>{const o=c.shows.find(a=>a.id===n.id);if(o&&o.participated){const a=[];r.forEach(y=>{var N;const S=(N=y.votes)==null?void 0:N.indexOf(c.country);S>-1?a.push(l[S]):c.country===y.country?a.push("-"):a.push("")});let u="";o.qualified?u="selected":o.won&&(u="firstplace"),e.push({country:c.country,order:o.order,showPoints:o.points,className:u,points:a,maxPoints:d})}}),{participants:e.sort((c,o)=>o.order-c.order),voters:r}}function V({data:t,show:n}){const e=G(t,n);return s.jsx("div",{style:{display:"flex",justifyContent:"center"},children:s.jsx("div",{className:"table-container",children:s.jsxs("table",{className:"table is-bordered is-striped is-narrow is-hoverable is-fullwidth",style:{width:"inherit"},children:[s.jsxs("thead",{children:[s.jsx("tr",{children:s.jsx("th",{colSpan:e.voters.length+5,style:{textAlign:"center"},children:"Detailed jury voting results"})}),s.jsxs("tr",{children:[s.jsx("th",{rowSpan:2,colSpan:2}),s.jsx("th",{rowSpan:2,style:{verticalAlign:"bottom"},children:s.jsx(g,{children:"Total score"})}),s.jsx("th",{rowSpan:2,style:{verticalAlign:"bottom"},children:s.jsx(g,{children:"Jury vote score"})}),s.jsx("th",{rowSpan:2,style:{verticalAlign:"bottom"},children:s.jsx(g,{children:"Televoting score"})}),s.jsx("th",{style:{textAlign:"center"},colSpan:e.voters.length,children:"Jury vote"})]}),s.jsx("tr",{children:e.voters.map((r,i)=>s.jsx("th",{style:{verticalAlign:"bottom"},children:s.jsx(g,{children:s.jsx(j,{children:s.jsx(x,{id:r.country,rotateFlag:!0})})})},i))})]}),s.jsx("tbody",{children:e.participants.map((r,i)=>s.jsxs("tr",{children:[i===0&&s.jsx("th",{style:{verticalAlign:"middle"},rowSpan:e.participants.length,children:s.jsx(g,{children:"Contestants"})}),s.jsx("th",{className:r.className,children:s.jsx(j,{children:s.jsx(x,{id:r.country})})}),s.jsx("td",{className:r.className,children:r.showPoints.total}),s.jsx("td",{className:r.className,children:r.showPoints.jury}),s.jsx("td",{className:r.className,children:r.showPoints.tele}),r.points.map((l,d)=>s.jsx("td",{style:{textAlign:"center"},className:`${r.className} ${l==="-"&&"blank"} ${l===r.maxPoints&&"has-text-weight-bold"}`,children:l!=="-"&&l},d))]},i))})]})})})}function U(t,n){var d;const e=n.votingMethod,r=(d=E.find(h=>h.value===e))==null?void 0:d.points[0],i=[];return t.entries.forEach(h=>{const c=h.shows.find(o=>o.id===n.id);if(c&&c.votes&&c.votes[0]){const o=c.votes[0],a=i.find(u=>u.country===o);a?a.givers.push(h.country):i.push({country:o,givers:[h.country]})}}),{maxPoints:r,getters:i.sort((h,c)=>c.givers.length-h.givers.length)}}function _({data:t,show:n}){const e=U(t,n);return e.getters.length===0?s.jsx(s.Fragment,{}):s.jsx(j,{children:s.jsxs("table",{className:"table is-bordered is-striped is-hoverable is-narrow",style:{width:"inherit"},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"N."}),s.jsx("th",{children:"Contestant"}),s.jsxs("th",{children:["Nation(s) giving ",e.maxPoints," points"]})]})}),s.jsx("tbody",{children:e.getters.map((r,i)=>s.jsxs("tr",{children:[s.jsx("th",{children:r.givers.length}),s.jsx("td",{children:s.jsx(x,{id:r.country})}),s.jsx("td",{children:r.givers.map((l,d)=>s.jsxs(s.Fragment,{children:[s.jsx(x,{id:l},d),d===r.givers.length-1?"":", "]}))})]},i))})]})})}function z(t,n){const e=[];return t.entries.forEach(r=>{const i=r.shows.find(l=>l.id===n);if(i!=null&&i.participated){let l="";i.qualified&&(l="selected"),n==="gf"&&(console.log(i),i.place===1?l="firstplace":i.place===2?l="secondplace":i.place===3&&(l="thirdplace")),e.push({ro:i.order,country:r.country,participant:r.hods,song:r.song,place:i.place,points:i.points.total,qualified:i.qualified,className:l})}}),e.sort((r,i)=>r.ro-i.ro),e}function H({entries:t}){return s.jsx(j,{children:s.jsx("div",{className:"my-5",children:s.jsx(f,{columns:["Order","Country","Participant","Artist","Song","Place","Points"],smallFirst:!0,compact:!0,children:t.map((n,e)=>s.jsxs("tr",{className:n.className,children:[s.jsx("td",{style:{textAlign:"center"},children:R(n.ro)}),s.jsx("td",{children:s.jsx(x,{id:n.country})}),s.jsx("td",{children:s.jsx(v,{userids:n.participant})}),s.jsx("td",{children:n.song.artists}),s.jsx("td",{children:s.jsx(b,{data:n.song,titleOnly:!0})}),s.jsx("td",{children:n.place}),s.jsx("td",{children:n.points})]},e))})})})}function K({entries:t}){return s.jsx(j,{children:s.jsx("div",{className:"my-5",children:s.jsx(f,{columns:["Country","Participant","Artist","Song"],compact:!0,children:t.map((n,e)=>s.jsxs("tr",{className:n.className,children:[s.jsx("td",{children:s.jsx(x,{id:n.country})}),s.jsx("td",{children:s.jsx(v,{userids:n.participant})}),s.jsx("td",{children:n.song.artists}),s.jsx("td",{children:s.jsx(b,{data:n.song,titleOnly:!0})})]},e))})})})}function Q({show:t,data:n}){const e=z(n,t);return e.find(i=>i.ro!=0||i.place!=0||i.points!=0)?s.jsx(H,{entries:e}):s.jsx(K,{entries:e})}function C(t,n,e){const r=[];return t.entries.forEach(i=>{const l=i.shows.find(d=>d.id===n);if(l){let d="";l.qualified&&(d="selected"),r.push({country:i.country,juryPoints:l.points.jury,telePoints:l.points.tele,className:d})}}),r.sort((i,l)=>l[e]-i[e])}function X({show:t,data:n}){const e=C(n,t,"juryPoints"),r=C(n,t,"telePoints");return!e.find(l=>l.juryPoints!=0||l.telePoints!=0)?s.jsx(s.Fragment,{}):s.jsx(j,{children:s.jsx("div",{className:"my-5",children:s.jsx("div",{className:"table-container",children:s.jsxs("table",{className:"table is-bordered is-striped is-hoverable is-narrow",style:{width:"inherit"},children:[s.jsxs("thead",{children:[s.jsx("tr",{children:s.jsx("th",{style:{textAlign:"center"},colSpan:5,children:"Split Results"})}),s.jsxs("tr",{style:{textAlign:"center"},children:[s.jsx("th",{rowSpan:2,children:"Place"}),s.jsx("th",{colSpan:2,children:"Jury"}),s.jsx("th",{colSpan:2,children:"Televoting"})]}),s.jsxs("tr",{children:[s.jsx("th",{children:"Country"}),s.jsx("th",{children:"Points"}),s.jsx("th",{children:"Country"}),s.jsx("th",{children:"Points"})]})]}),s.jsx("tbody",{children:e.map((l,d)=>s.jsxs("tr",{children:[s.jsx("th",{style:{textAlign:"center"},children:d+1}),s.jsx("td",{className:l.className,children:s.jsx(x,{id:l.country})}),s.jsx("td",{className:l.className,children:l.juryPoints}),s.jsx("td",{className:r[d].className,children:s.jsx(x,{id:r[d].country})}),s.jsx("td",{className:r[d].className,children:r[d].telePoints})]},d))})]})})})})}function Y({data:t,show:n}){return n.textContent||t.entries.find(r=>r.shows.find(i=>i.id===n.id))?s.jsxs("div",{className:"mb-5",children:[s.jsx("h2",{children:w[n.id]}),s.jsx(p,{value:n.textContent}),s.jsx(Q,{data:t,show:n.id}),s.jsxs("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-around",flexWrap:"wrap"},children:[s.jsx(X,{data:t,show:n.id}),s.jsx(_,{data:t,show:n})]}),s.jsx(V,{data:t,show:n})]}):s.jsx(s.Fragment,{})}function Z({entries:t}){return t.find(e=>e.shows.length>0)?s.jsx(s.Fragment,{}):s.jsxs(s.Fragment,{children:[s.jsx("h1",{children:"Participants"}),s.jsx("hr",{}),s.jsx(f,{columns:["Country","Participant","Artist","Song"],children:t.map((e,r)=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx(j,{children:s.jsx(x,{id:e.country})})}),s.jsx("td",{children:s.jsx(v,{userids:e.hods})}),s.jsx("td",{children:e.song.artists}),s.jsx("td",{children:s.jsx(b,{data:e.song,titleOnly:!0})})]},r))})]})}function js(){var c;const{roesc:t,edition:n}=F(),[e,r]=m.useState(),[i,l]=m.useState(),[d,h]=m.useState("");return m.useEffect(()=>{M(t,n).then(o=>r(o)).catch(o=>h(o)),k(t).then(o=>l(o)).catch(()=>{})},[t,n]),!e||!i?s.jsx("h1",{children:"Loading..."}):d?s.jsxs("h1",{children:["Error: ",d]}):s.jsxs("div",{children:[s.jsx("h1",{children:e.fullName}),s.jsx("hr",{}),s.jsx(W,{data:e,roescData:i}),s.jsx(p,{value:e.textContent}),(e.biddingText||e.bidding.length>0)&&s.jsxs(s.Fragment,{children:[s.jsx("h1",{children:"Location"}),s.jsx("hr",{}),s.jsx(p,{value:e.biddingText,overrides:{BiddingTable:{component:T,props:{data:e.bidding}}}}),e.bidding.length>0&&!L(e.biddingText,"BiddingTable")&&s.jsx(T,{data:e.bidding})]}),(e.sfDrawText||e.sfDraw.length>0)&&s.jsxs(s.Fragment,{children:[s.jsx("h1",{children:"Semi-Final Allocation Draw"}),s.jsx("hr",{}),s.jsx(p,{value:e.sfDrawText}),s.jsx(j,{children:s.jsx(f,{columns:e.sfDraw.map((o,a)=>`Pot ${a+1}`),children:s.jsx("tr",{children:e.sfDraw.map((o,a)=>s.jsx("td",{children:s.jsx("ul",{style:{marginTop:0},children:o.map((u,y)=>s.jsx("li",{children:s.jsx(x,{id:u})},y))})},a))})})})]}),s.jsx(Z,{entries:e.entries}),s.jsx("h1",{children:"Shows"}),s.jsx("hr",{}),e.shows.map(o=>s.jsx(Y,{show:o,data:e},o.id)),s.jsx("div",{style:{marginTop:"2rem"}}),((c=e.replacements)==null?void 0:c.length)>0&&s.jsxs(s.Fragment,{children:[s.jsx("h1",{children:"Original entries"}),s.jsx("hr",{}),s.jsx(f,{columns:["Country","Participant","Artists","Song"],children:e.replacements.map((o,a)=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx(j,{children:s.jsx(x,{id:o.country})})}),s.jsx("td",{children:s.jsx(v,{userids:[o.participant]})}),s.jsx("td",{children:o.song.artists}),s.jsx("td",{children:s.jsx(b,{data:o.song,titleOnly:!0})})]},a))})]}),e.incidents&&s.jsxs(s.Fragment,{children:[s.jsx("h1",{children:"Incidents"}),s.jsx("hr",{}),s.jsx(p,{value:e.incidents}),s.jsx("div",{style:{marginTop:"2rem"}})]}),s.jsx($,{media:e.media}),s.jsx("hr",{style:{clear:"both"}}),s.jsx(D,{to:`/editor/edition/existing/${i.link}/${e.link}`,className:"button is-primary is-outlined",children:"Edit This Page"})]})}export{js as default};
